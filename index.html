
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Widget Creator Tool</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 900px; margin: 0 auto; padding: 20px; }
    .container { border: 1px solid #ddd; border-radius: 5px; padding: 20px; }
    h1 { text-align: center; color: #333; }
    .tab-container { display: flex; border-bottom: 1px solid #ccc; margin-bottom: 20px; flex-wrap: wrap; }
    .tab-button { background-color: #f1f1f1; border: 1px solid #ccc; border-bottom: none; border-radius: 5px 5px 0 0; padding: 10px 20px; cursor: pointer; font-weight: bold; margin-right: 5px; margin-bottom: 5px; }
    .tab-button.active { background-color: white; border-bottom: 2px solid white; color: #4CAF50; }
    .tab-content { display: none; padding: 20px; border: 1px solid #ddd; border-radius: 0 0 5px 5px; }
    .tab-content.active { display: block; }
    label { display: block; margin-top: 15px; font-weight: bold; }
    input, select, textarea { width: 100%; padding: 8px; margin-top: 5px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
    .button-row { display: flex; gap: 10px; margin: 20px 0; }
    button { background-color: #4CAF50; color: white; border: none; padding: 10px 15px; border-radius: 4px; cursor: pointer; }
    button:hover { background-color: #45a049; }
    .clear-btn { background-color: #6c757d; }
    .clear-btn:hover { background-color: #5a6268; }
    .output { margin-top: 30px; }
    .preview-box { border: 1px solid #ddd; border-radius: 4px; padding: 15px; min-height: 150px; margin-bottom: 20px; text-align: center; }
    #pdf-preview img { max-width: 100%; max-height: 500px; }
    .image-preview { max-width: 100%; min-height: 100px; margin-top: 10px; background-color: #f0f0f0; display: flex; align-items: center; justify-content: center; color: #666; text-align: center; padding: 10px; }
    .image-preview img { max-width: 100%; max-height: 200px; display: block; margin: 0 auto; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
  </style>
</head>
<body>
  <div class="container">
    <h1>Widget Creator Tool</h1>
    <div class="tab-container">
      <button class="tab-button active" onclick="openTab(event, 'tab1')">Website Widget</button>
      <button class="tab-button" onclick="openTab(event, 'tab2')">Feature Widget</button>
      <button class="tab-button" onclick="openTab(event, 'tab3')">Product Widget</button>
      <button class="tab-button" onclick="openTab(event, 'tab4')">Paste Widget</button>
      <button class="tab-button" onclick="openTab(event, 'tab5')">Cover Page Creator</button>
    </div>
    <div id="tab1" class="tab-content active">
      <h2>Website Widget</h2>
      <label for="url-input">Enter URL:</label>
      <input type="text" id="url-input" value="https://example.com/services">
      <label for="layout-select">Image Position:</label>
      <select id="layout-select">
        <option value="right">Right</option>
        <option value="left">Left</option>
      </select>
      <label for="paragraph-count">Number of Paragraphs:</label>
      <select id="paragraph-count">
        <option value="1">1 Paragraph</option>
        <option value="2">2 Paragraphs</option>
        <option value="3">3 Paragraphs</option>
      </select>
      <div class="image-upload-section">
        <label for="website-image-upload">Upload Image:</label>
        <input type="file" id="website-image-upload" accept="image/*">
        <div id="website-image-preview" class="image-preview">No image uploaded</div>
      </div>
      <div class="button-row">
        <button onclick="generateWebsite()">Generate HTML</button>
        <button onclick="clearWebsite()">Clear Fields</button>
      </div>
      <div class="output">
        <h3>Preview:</h3>
        <div id="website-preview" class="preview-box"></div>
        <h3>HTML Output:</h3>
        <div class="copy-container">
          <button onclick="copyWebsiteHTML()">Copy HTML</button>
        </div>
        <textarea id="website-output" rows="10"></textarea>
      </div>
    </div>
<div id="tab2" class="tab-content">
  <h2>Feature Widget</h2>
  <label for="feature-title">Widget Title:</label>
  <input type="text" id="feature-title" value="Key Features">
  <label for="feature-layout">Layout Style:</label>
  <select id="feature-layout">
    <option value="list">List</option>
    <option value="grid">Grid</option>
  </select>
  <div id="feature-items">
    <div class="feature-item">
      <input type="text" placeholder="Feature title" value="24/7 Support">
      <input type="text" placeholder="Feature description" value="Round-the-clock technical support">
      <button onclick="removeFeature(this)">Remove</button>
    </div>
  </div>
  <div class="button-row">
    <button onclick="addFeature()">Add Feature</button>
    <button onclick="generateFeature()">Generate HTML</button>
    <button onclick="clearFeature()" class="clear-btn">Clear Fields</button>
  </div>
  <div class="output">
    <h3>Preview:</h3>
    <div id="feature-preview" class="preview-box"></div>
    <h3>HTML Output:</h3>
    <div class="copy-container">
      <button onclick="copyFeatureHTML()">Copy HTML</button>
    </div>
    <textarea id="feature-output" rows="10"></textarea>
  </div>
</div>
<div id="tab3" class="tab-content">
  <h2>Product Widget</h2>
  <label for="product-name">Product Name:</label>
  <input type="text" id="product-name" value="Sophos XGS 136 Firewall">
  <label for="product-type">Product Type:</label>
  <select id="product-type">
    <option value="firewall">Firewall/Security</option>
    <option value="server">Server</option>
    <option value="storage">Storage</option>
    <option value="network">Network Device</option>
    <option value="software">Software</option>
  </select>
  <label for="product-layout">Layout Style:</label>
  <select id="product-layout">
    <option value="right">Image Right</option>
    <option value="left">Image Left</option>
  </select>
  <label for="product-paragraph-count">Number of Paragraphs:</label>
  <select id="product-paragraph-count">
    <option value="1">1 Paragraph</option>
    <option value="2">2 Paragraphs</option>
    <option value="3">3 Paragraphs</option>
  </select>
  <label for="product-feature-count">Number of Features:</label>
  <select id="product-feature-count">
    <option value="3">3 Features</option>
    <option value="4">4 Features</option>
    <option value="5">5 Features</option>
  </select>
  <div class="image-upload-section">
    <label for="product-image-upload">Upload Product Image:</label>
    <input type="file" id="product-image-upload" accept="image/*">
    <div id="product-image-preview" class="image-preview">No image uploaded</div>
  </div>
  <div class="button-row">
    <button onclick="generateProduct()">Generate Product Widget</button>
    <button onclick="clearProduct()" class="clear-btn">Clear Fields</button>
  </div>
  <div class="output">
    <h3>Preview:</h3>
    <div id="product-preview" class="preview-box"></div>
    <h3>HTML Output:</h3>
    <div class="copy-container">
      <button onclick="copyProductHTML()">Copy HTML</button>
    </div>
    <textarea id="product-output" rows="10"></textarea>
  </div>
</div>
<div id="tab4" class="tab-content">
  <h2>Paste Widget</h2>
  <label for="paste-area">Paste Content from Word Document:</label>
  <textarea id="paste-area" placeholder="Paste your Word document content here..."></textarea>
  <div class="button-row">
    <button onclick="cleanPastedContent()">Clean & Format HTML</button>
    <button onclick="clearPasteArea()" class="clear-btn">Clear Content</button>
  </div>
  <div class="output">
    <h3>Preview:</h3>
    <div id="paste-preview" class="preview-box"></div>
    <h3>HTML Output:</h3>
    <div class="copy-container">
      <button onclick="copyPasteHTML()">Copy HTML</button>
    </div>
    <textarea id="paste-output" rows="10"></textarea>
  </div>
</div>
<div id="tab5" class="tab-content">
  <h2>Cover Page Creator</h2>
  <label for="pdf-upload">Upload PDF:</label>
  <input type="file" id="pdf-upload" accept="application/pdf">
  <label for="pdf-dpi">Image Quality:</label>
  <select id="pdf-dpi">
    <option value="150">Low (150 DPI)</option>
    <option value="300" selected>Medium (300 DPI)</option>
    <option value="600">High (600 DPI)</option>
  </select>
  <label for="pdf-page">Page to Process:</label>
  <input type="number" id="pdf-page" value="1" min="1" max="999">
  <div class="button-row">
    <button onclick="processPDFFile()">Create Cover Page</button>
    <button onclick="clearPDF()" class="clear-btn">Clear</button>
  </div>
  <div class="output">
    <h3>Preview:</h3>
    <div id="pdf-preview" class="preview-box">
      <p>Cover page preview will appear here</p>
    </div>
    <div id="pdf-download" style="display: none; text-align: center;">
      <button onclick="downloadProcessedPDF()">Download Cover Page</button>
    </div>
  </div>
</div>
<script>
let websiteImageData = null;
let productImageData = null;
let processedImageData = null;

function openTab(evt, tabName) {
  const tabContents = document.getElementsByClassName("tab-content");
  for (let content of tabContents) {
    content.classList.remove("active");
  }
  const tabButtons = document.getElementsByClassName("tab-button");
  for (let button of tabButtons) {
    button.classList.remove("active");
  }
  document.getElementById(tabName).classList.add("active");
  evt.currentTarget.classList.add("active");
}

function generateWebsite() {
  const url = document.getElementById('url-input').value;
  const layout = document.getElementById('layout-select').value;
  const paragraphCount = parseInt(document.getElementById('paragraph-count').value);

  let paragraphs = [
    "This is paragraph 1 from the website.",
    "This is paragraph 2 with more details.",
    "This is paragraph 3 providing additional information."
  ];

  let contentHtml = '';
  for (let i = 0; i < paragraphCount; i++) {
    contentHtml += `<p>${paragraphs[i]}</p>`;
  }

  let imageHtml = websiteImageData
    ? `<img src="${websiteImageData}" alt="Website Image" style="max-width: 100%;">`
    : `<div style="background: #f0f0f0; height: 200px; display: flex; align-items: center; justify-content: center;">Image Placeholder</div>`;

  const html = `<div style="font-family: Arial; max-width: 900px; margin: 0 auto;">
    <table style="width: 100%; border-collapse: collapse;">
      <tr>
        ${layout === 'left' ? `<td style="width: 30%; padding: 20px;">${imageHtml}</td>` : ''}
        <td style="padding: 20px;">
          <h2>Website Content</h2>
          ${contentHtml}
        </td>
        ${layout === 'right' ? `<td style="width: 30%; padding: 20px;">${imageHtml}</td>` : ''}
      </tr>
    </table>
  </div>`;

  document.getElementById('website-output').value = html;
  document.getElementById('website-preview').innerHTML = html;
}

function clearWebsite() {
  document.getElementById('url-input').value = '';
  document.getElementById('layout-select').value = 'right';
  document.getElementById('paragraph-count').value = '1';
  document.getElementById('website-output').value = '';
  document.getElementById('website-preview').innerHTML = '';
  document.getElementById('website-image-preview').innerHTML = 'No image uploaded';
  websiteImageData = null;
  document.getElementById('website-image-upload').value = '';
}

function copyWebsiteHTML() {
  const textarea = document.getElementById('website-output');
  textarea.select();
  document.execCommand('copy');
  alert('HTML copied to clipboard!');
}

document.getElementById('website-image-upload').addEventListener('change', function(e) {
  const file = e.target.files[0];
  if (!file || !file.type.match('image.*')) {
    alert('Please select a valid image file.');
    return;
  }
  const reader = new FileReader();
  reader.onload = function(event) {
    websiteImageData = event.target.result;
    document.getElementById('website-image-preview').innerHTML = `<img src="${websiteImageData}" alt="Website Image">`;
  };
  reader.readAsDataURL(file);
});


function addFeature() {
  const container = document.getElementById('feature-items');
  const newFeature = document.createElement('div');
  newFeature.className = 'feature-item';
  newFeature.innerHTML = `
    <input type="text" placeholder="Feature title" value="New Feature">
    <input type="text" placeholder="Feature description" value="Feature description">
    <button onclick="removeFeature(this)">Remove</button>
  `;
  container.appendChild(newFeature);
}

function removeFeature(button) {
  button.parentElement.remove();
}

function generateFeature() {
  const title = document.getElementById('feature-title').value;
  const layout = document.getElementById('feature-layout').value;
  const featureItems = document.querySelectorAll('#feature-items .feature-item');

  let features = [];
  featureItems.forEach(item => {
    const inputs = item.querySelectorAll('input');
    if (inputs.length === 2) {
      features.push({ title: inputs[0].value, description: inputs[1].value });
    }
  });

  let html = `<div style="font-family: Arial; max-width: 900px; margin: 0 auto;">
    <h2 style="text-align: center; margin-bottom: 20px;">${title}</h2>
  `;

  if (layout === 'grid') {
    html += '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">';
    features.forEach(f => {
      html += `
        <div style="background: #f9f9f9; padding: 20px; border-radius: 5px; text-align: center;">
          <h3 style="margin-top: 0;">${f.title}</h3>
          <p>${f.description}</p>
        </div>`;
    });
    html += '</div>';
  } else {
    html += '<div>';
    features.forEach(f => {
      html += `
        <div style="background: #f9f9f9; padding: 15px; border-radius: 5px; margin-bottom: 10px; display: flex;">
          <div style="margin-right: 15px; color: green; font-weight: bold;">✓</div>
          <div>
            <h3 style="margin-top: 0;">${f.title}</h3>
            <p>${f.description}</p>
          </div>
        </div>`;
    });
    html += '</div>';
  }

  html += '</div>';
  document.getElementById('feature-output').value = html;
  document.getElementById('feature-preview').innerHTML = html;
}

function clearFeature() {
  document.getElementById('feature-title').value = 'Key Features';
  document.getElementById('feature-layout').value = 'list';
  document.getElementById('feature-items').innerHTML = `
    <div class="feature-item">
      <input type="text" placeholder="Feature title" value="24/7 Support">
      <input type="text" placeholder="Feature description" value="Round-the-clock technical support">
      <button onclick="removeFeature(this)">Remove</button>
    </div>`;
  document.getElementById('feature-output').value = '';
  document.getElementById('feature-preview').innerHTML = '';
}

function copyFeatureHTML() {
  const textarea = document.getElementById('feature-output');
  textarea.select();
  document.execCommand('copy');
  alert('HTML copied to clipboard!');
}



function generateProduct() {
  const name = document.getElementById('product-name').value;
  const type = document.getElementById('product-type').value;
  const layout = document.getElementById('product-layout').value;
  const paragraphCount = parseInt(document.getElementById('product-paragraph-count').value);
  const featureCount = parseInt(document.getElementById('product-feature-count').value);

  const paragraphs = Array.from({ length: paragraphCount }, (_, i) => `This is paragraph ${i + 1} about the product.`);
  const features = Array.from({ length: featureCount }, (_, i) => `Feature ${i + 1}`);

  let descriptionsHtml = paragraphs.map(p => `<p>${p}</p>`).join('');
  let featuresHtml = '<h3 style="margin-top: 20px;">Key Features</h3><ul>' +
    features.map(f => `<li style="margin-bottom: 8px;">${f}</li>`).join('') + '</ul>';

  let imageHtml = productImageData
    ? `<img src="${productImageData}" alt="${name}" style="max-width: 100%; display: block;">`
    : `<div style="background: #f0f0f0; height: 240px; display: flex; align-items: center; justify-content: center;">Product Image</div>`;

  const html = `<div style="font-family: Arial; max-width: 900px; margin: 0 auto;">
    <table style="width: 100%; border-collapse: collapse;">
      <tr>
        ${layout === 'left' ? `<td style="width: 30%; padding: 20px;">${imageHtml}</td>` : ''}
        <td style="padding: 20px;">
          <h2 style="margin-top: 0;">${name}</h2>
          ${descriptionsHtml}
          ${featuresHtml}
        </td>
        ${layout === 'right' ? `<td style="width: 30%; padding: 20px;">${imageHtml}</td>` : ''}
      </tr>
    </table>
  </div>`;

  document.getElementById('product-output').value = html;
  document.getElementById('product-preview').innerHTML = html;
}

function clearProduct() {
  document.getElementById('product-name').value = 'Sophos XGS 136 Firewall';
  document.getElementById('product-type').value = 'firewall';
  document.getElementById('product-layout').value = 'right';
  document.getElementById('product-paragraph-count').value = '1';
  document.getElementById('product-feature-count').value = '3';
  document.getElementById('product-output').value = '';
  document.getElementById('product-preview').innerHTML = '';
  document.getElementById('product-image-preview').innerHTML = 'No image uploaded';
  productImageData = null;
  document.getElementById('product-image-upload').value = '';
}

function copyProductHTML() {
  const textarea = document.getElementById('product-output');
  textarea.select();
  document.execCommand('copy');
  alert('HTML copied to clipboard!');
}

document.getElementById('product-image-upload').addEventListener('change', function(e) {
  const file = e.target.files[0];
  if (!file || !file.type.match('image.*')) {
    alert('Please select a valid image file.');
    return;
  }
  const reader = new FileReader();
  reader.onload = function(event) {
    productImageData = event.target.result;
    document.getElementById('product-image-preview').innerHTML = `<img src="${productImageData}" alt="Product Image">`;
  };
  reader.readAsDataURL(file);
});
function cleanPastedContent() {
  const pasteArea = document.getElementById('paste-area');
  const content = pasteArea.value;

  if (!content.trim()) {
    alert('Please paste some content first.');
    return;
  }

  const lines = content.split('\n');
  let cleanedHTML = '';
  let inList = false;

  lines.forEach(line => {
    line = line.trim();
    if (!line) {
      if (inList) {
        cleanedHTML += '</ul>\n';
        inList = false;
      }
      return;
    }

    if (/^([\u2022\*\-\d\)]+)\s+/.test(line)) {
      line = line.replace(/^([\u2022\*\-\d\)]+)\s+/, '');
      if (!inList) {
        cleanedHTML += '<ul>\n';
        inList = true;
      }
      cleanedHTML += `  <li>${line}</li>\n`;
    } else {
      if (inList) {
        cleanedHTML += '</ul>\n';
        inList = false;
      }
      cleanedHTML += `<p>${line}</p>\n`;
    }
  });

  if (inList) cleanedHTML += '</ul>\n';

  const formattedHTML = `<div style="font-family: Arial; max-width: 900px; margin: 0 auto; line-height: 1.5;">\n${cleanedHTML}</div>`;

  document.getElementById('paste-output').value = formattedHTML;
  document.getElementById('paste-preview').innerHTML = formattedHTML;
}

function clearPasteArea() {
  document.getElementById('paste-area').value = '';
  document.getElementById('paste-output').value = '';
  document.getElementById('paste-preview').innerHTML = '';
}

function copyPasteHTML() {
  const textarea = document.getElementById('paste-output');
  textarea.select();
  document.execCommand('copy');
  alert('HTML copied to clipboard!');
}
function processPDFFile() {
  const fileInput = document.getElementById('pdf-upload');
  const file = fileInput.files[0];

  if (!file) {
    alert('Please select a PDF file first.');
    return;
  }

  const reader = new FileReader();
  reader.readAsDataURL(file);

  reader.onload = async function () {
    try {
      const base64Data = reader.result.split(',')[1];

      const response = await fetch('/.netlify/functions/pdf_processor', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          filename: file.name,
          file: base64Data
        })
      });

      console.log("Response status:", response.status);

      const result = await response.json();

      if (!response.ok || result.error) {
        throw new Error(result.error || 'PDF processing failed.');
      }

      processedImageData = `data:image/png;base64,${result.image}`;
      document.getElementById('pdf-preview').innerHTML =
        `<img src="${processedImageData}" style="max-width: 100%; max-height: 500px;">`;
      document.getElementById('pdf-download').style.display = 'block';
    } catch (err) {
      document.getElementById('pdf-preview').innerHTML =
        `<p style="color: red;">Error processing PDF: ${err.message}</p>`;
    }
  };

  reader.onerror = function () {
    document.getElementById('pdf-preview').innerHTML =
      `<p style="color: red;">Error reading PDF: ${reader.error}</p>`;
  };
}
function clearPDF() {
  document.getElementById('pdf-upload').value = '';
  document.getElementById('pdf-page').value = '1';
  document.getElementById('pdf-preview').innerHTML = '<p>Cover page preview will appear here</p>';
  document.getElementById('pdf-download').style.display = 'none';
  processedImageData = null;
}

</script>
</body>
</html>
